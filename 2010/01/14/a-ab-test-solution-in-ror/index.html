
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>@yorzi: an A/B test solution in ROR</title>
  <meta name="author" content="Andy Wang">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="canonical" href="http://blog.wangyaodi.com/2010/01/14/a-ab-test-solution-in-ror/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://s3.amazonaws.com/ender-js/jeesh.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <link href="/atom.xml" rel="alternate" title="@yorzi" type="application/atom+xml"/>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-11967621-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

</head>

<body  >
  <header><hgroup>
  <h1><a href="/" style="color:red">@yorzi</a></h1>
  
  <a href="https://github.com/yorzi/life_blog"><img style="position: absolute; top: 0; right: 0; border: 0;" src="/images/forkme.png" alt="Fork me on GitHub"></a>
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss email">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="wangyaodi@gmail.com" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:blog.wangyaodi.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="http://tech.wangyaodi.com">技术闲谈</a></li>
  <li><a href="http://about.me/wangyaodi">关于安迪</a></li>
  <li><a href="/blog/archives">博客存档</a></li>
  <li><a href="https://plus.google.com/108320517625960982177/about?hl=en" style="color:red">@yorzi</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry">
  
  <header>
    
      <h1 class="entry-title">An A/B Test Solution in ROR</h1>
    
    
      <p class="meta">




<time datetime="2010-01-14 00:00:00 +0800" pubdate  updated >Jan 14<span>th</span>, 2010</time>


</p>
    
  </header>


<div class="entry-content"><p>Last few days, I worked for a mission to add more flexible control to <a href="http://www.eqenglish.com">our website</a> landing pages. What I did is to add a &#8220;a/b&#8221; test feature for new landing pages, that means, if people have two designs and want to compare the results, they only release two versions of landing page, and then only get one url for the two versions of pages, after that the url will automatically redirect to different versions evenly, so that through Google analytics marketing people can easily decide which landing page is much better.</p>




<p><strong>Landing pages A/B test solution:</strong>
<code lang="ruby">
class LandingsController < ApplicationController<br />
  layout "layouts/blank"<br />
  caches_page "ielts","ab_test"</code></p>

<p>  def ielts<br />
    @landing_page = Landing.find_by_url_slug(params[:url_slug]) || Landing.valid_landings.first<br />
    if @landing_page.ab_test?<br />
      if not params[:channel].blank?<br />
        redirect_to landing_ab_test_with_channel_path([&#8220;a&#8221;,&#8221;b&#8221;].rand,params[:url_slug],params[:channel])<br />
      else<br />
        redirect_to landing_ab_test_path([&#8220;a&#8221;,&#8221;b&#8221;].rand,params[:url_slug])<br />
      end<br />
    else<br />
      render :layout => &#8220;layouts/landing_page&#8221;<br />
    end<br />
  end</p>

<p>  def ab_test<br />
    @landing_page = Landing.find_by_url_slug(params[:type].to_s + &#8220;/&#8221; + params[:url_slug].to_s)<br />
    (@landing_page = Landing.find_by_url_slug(params[:url_slug]) || Landing.valid_landings.first) if @landing_page.nil?<br />
    render :layout => &#8220;layouts/landing_page&#8221;<br />
  end<br />
end

<strong>Routing:</strong>
<code lang="ruby">
   map.landing_trunk "ielts/:url_slug", :controller => "landings", :action => "ielts"<br />
   map.landing_trunk_with_channel "ielts/:url_slug/:channel", :controller => "landings", :action => "ielts"<br />
   map.landing_ab_test "ielts/sub/:type/:url_slug/", :controller => "landings", :action => "ab_test"<br />
   map.landing_ab_test_with_channel "ielts/sub/:type/:url_slug/:channel", :controller => "landings", :action => "ab_test"
</code></p>

<p><strong>A/B test Sample:</strong>
<em>Suppose</em>:<br />
              We release a type of landing page called : university<br />
              And we have two kinds of different designs : called &#8220;a/university&#8221; and &#8220;b/university&#8221;<br />
              Then we may release the landing page to many universities, such as &#8220;beida&#8221;, &#8220;renda&#8221;, &#8220;qinghua&#8221; etc.. they are different channels.</p>

<p><em>Then we can</em>:<br />
             Only release the url as &#8220;http://www.eqenglish.com/ielts/university&#8221; to any universities by following &#8220;/beida&#8221;, &#8220;/renda&#8221;, &#8220;/qinghua&#8221; etc&#8230;<br />
             It should be like this &#8220;http://www.eqenglish.com/ielts/university/beida&#8221;,  &#8220;http://www.eqenglish.com/ielts/university/renda&#8221;&#8230; etc.. (For client use)<br />
             But in google analytics, you will see : &#8220;http://www.eqenglish.com/ielts/sub/a/university/beida&#8221;<br />
                                                                  and : &#8220;http://www.eqenglish.com/ielts/sub/b/university/beida&#8221;  (For our analysis)</p>

<p> It means, different landing page and different channel and (&#8220;a&#8221; or &#8220;b&#8221;) will be in a unique URL for certain purpose. but for our client, they don&#8217;t need to care about &#8220;a/b&#8221; test, system will redirect pages automatically.</p>

<p>Any involving comments are welcomed.</p>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Andy Wang</span></span>

      




<time datetime="2010-01-14 00:00:00 +0800" pubdate  updated >Jan 14<span>th</span>, 2010</time>



      

<span class="categories">
  
    <a class='category' href='/blog/categories/Tech-Notes/'>Tech Notes</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  <g:plusone size="medium"></g:plusone>
  
</div>

    
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread"><div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'andyspersonalblog';
  var disqus_identifier = 'http://blog.wangyaodi.com/2010/01/14/a-ab-test-solution-in-ror/';
  var disqus_url = 'http://blog.wangyaodi.com/2010/01/14/a-ab-test-solution-in-ror/';
  //var disqus_developer = 1;
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside role=sidebar>
  
    <section>
  <img src="http://farm8.staticflickr.com/7401/8772484013_a1af7dc483_o.jpg"></img>
  <p><b style="color:red">安迪</b><br />
     <b style="color:red">西安</b>, 中国 <br />
     <b style="color:red">自由职业</b> at <a href="http://intridea.com">Intridea</a></p>
</section>
<section>
  <h1>近期博文</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/12/06/31-years-old/">31岁了</a>
      </li>
    
      <li class="post">
        <a href="/2013/09/01/xian-rubyists-on-trello/">如何用Trello组织西安Rubyists聚会</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/21/be-open-to-express-yourself/">从容表达</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/20/remote-working/">远程工作那些事儿</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/17/xian-rubyists-party-v2/">西安Rubyists线下活动通知[20130720]</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/07/on-the-road/">在路上</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/05/bookclub/">读书俱乐部</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/25/random-thoughts/">莫愁前路无知己</a>
      </li>
    
  </ul>
  <p><a style="color:red" href="/blog/archives">更多&#8230;</a></p>
</section>

<section>
  <h1>新浪微博</h1>
  <ul id="weibo">
    <li>
      <iframe 
        width="100%" 
        height="550" 
        class="share_self" 
        frameborder="0" 
        scrolling="no" 
        src="http://widget.weibo.com/weiboshow/index.php?width=0&height=550&ptype=1&speed=0&skin=&isTitle=0&noborder=1&isWeibo=1&isFans=&uid=1692318703&verifier=27e84cd9&dpc=1">
      </iframe>
    </li>
  </ul>
</section>


  
</aside>


    </div>
  </div>
  <footer><p>
  Copyright &copy; 2013 - Andy Wang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
</body>
</html>
